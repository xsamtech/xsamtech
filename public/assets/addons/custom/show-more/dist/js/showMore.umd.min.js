!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ShowMore=t()}(this,(function(){"use strict";const e=(e,t)=>{let{rows:s,children:n}=e;const i="table"===t?s:n,l=[].slice.call(i).filter(e=>e.classList.contains("hidden")).length;return 0!==l?" "+l:""},t=function(e,t){return void 0===t&&(t=!1),e.classList[t?"add":"remove"]("hidden")},s=(e,t)=>{for(let s in t)e.setAttribute(s,t[s])},n=e=>document.createElement(e),i={newLine:{match:/(\r\n|\n|\r)/gm,replace:""},space:{match:/\s\s+/gm,replace:" "},br:{match:/<br\s*\/?>/gim,replace:""},html:{match:/(<((?!b|\/b|!strong|\/strong)[^>]+)>)/gi,replace:""}},l={typeElement:"span",more:!1,less:!1,number:!1,nobutton:!1,after:0,btnClass:"show-more-btn",btnClassAppend:null};return class{constructor(r,o){let{onMoreLess:a=(()=>{}),regex:h={},config:c}=void 0===o?{}:o;this.t=()=>{const{element:e,after:i,ellipsis:l,nobutton:r,limit:o,type:a}=this.s;s(e,{"aria-expanded":"false"});const h=o+i,c=!1===l?"":"...";if("text"===a){const t=e.innerHTML.trim();if(e.textContent.trim().length>h){let s=t;for(let e in this.i){const{match:t,replace:n}=this.i[e];e&&t&&(s=s.replace(t,n))}const i=((e,t)=>{let s=n("div");return s.insertAdjacentHTML("afterbegin",e),function e(t,s){let n=t.firstChild;do{3===n.nodeType?s(n):1===n.nodeType&&n.childNodes&&n.childNodes[0]&&e(n,s)}while(n=n.nextSibling)}(s,(function(e){if(t>0){let s=e.data.length;(t-=s)<=0&&(e.data=e.substringData(0,e.data.length+t))}else e.data=""})),s.innerHTML})(s,o-1).concat(c);if(e.textContent="",e.insertAdjacentHTML("beforeend",i),this.l(e,{...this.s,originalText:t,truncatedText:i}),r)return;this.o(this.s)}}if("list"===a||"table"===a){const s=this.h(e,a);if(s.length>h){for(let e=o;e<s.length;e++)t(s[e],!0);if(r||this.o(this.s),this.l("list"===a?e:e.nextElementSibling,this.s),r)return}}},this.l=(e,t)=>e.addEventListener("click",this.p.bind(this,t)),this.m=t=>{let{element:i,number:l,less:r,more:o,type:a,btnClass:h,btnClassAppend:c}=t;const f=this.u?r||"":o||"",d=this.u?"collapse":"expand",p=!!this.u,m=n("button");return m.className=null==c?h:h+" "+c,s(m,{"aria-expanded":p,"aria-label":d,tabindex:0}),m.insertAdjacentHTML("beforeend",l?f+e(i,a):f),m},this.p=(e,s)=>{let{target:i}=s;const{element:l,type:r,limit:o,less:a,typeElement:h,originalText:c,truncatedText:f,btnClass:d}=e,p=i.classList.contains(d);if(!p)return;const m=l.getAttribute("aria-expanded");if(this.u="false"===m,"text"===r&&p&&(l.textContent="",l.insertAdjacentHTML("beforeend",this.u?c:f),a)){const t=n(h);t.classList.add("show-more-wrapper"),t.insertAdjacentElement("beforeend",this.m(e)),l.appendChild(t)}if("list"===r||"table"===r){const e=this.h(l,r);for(let s=0;s<e.length;s++){const n="list"===r?s>=o&&s<e.length-1:s>=o;"false"===m?t(e[s]):n&&t(e[s],!0)}}r&&this.g({...e,target:i})},this.h=(e,t)=>"list"===t?[].slice.call(e.children):e.rows,this.o=e=>{const{type:t,element:s,more:i,typeElement:l}=e;if(i)if("table"===t)s.insertAdjacentElement("afterend",this.m(e));else{const t=n(l);t.classList.add("show-more-wrapper"),t.appendChild(this.m(e)),s.appendChild(t)}},this.g=t=>{const{element:n,type:i,less:l,more:r,number:o,target:a}=t,h=this.u?l:r,c=this.u?"expand":"collapse",f="table"===i?i:"the "+i,d=n.lastElementChild;s(n,{"aria-expanded":this.u}),s(a,{"aria-expanded":this.u,"aria-label":c+" "+f}),this.T(c,t),h?a.innerHTML=o?h+e(n,i):h:"table"===i?a.parentNode.removeChild(a):"list"===i&&d.parentNode.removeChild(d)};const f=[].slice.call(document.querySelectorAll(r));this.T=a,this.i={...i,...h},f.map((e,t)=>{const s=JSON.parse(e.getAttribute("data-config")),n={...c,...s};this.s={index:t,classArray:e.classList,...l,...n,typeElement:n.element||"span",element:e},this.t()})}}}));
